var ft=Object.defineProperty;var pt=(r,e,t)=>e in r?ft(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ne=(r,e,t)=>(pt(r,typeof e!="symbol"?e+"":e,t),t);import{r as S,f as mt,a as o,b as j,g as ze,d as _,h as C,T as I,u as F,j as y,s as P,B as We,H as vt,i as Dt,k as yt,l as H,A as le,I as qe,m as xe,n as Ve,o as ue,p as me,c as J,L as Ge,q as Ne,t as ve,v as Re,w as Pe,x as Ot,y as St,z as bt,D as Tt,E as wt}from"./index.8778aa93.js";const Xe=S.exports.createContext({dragDropManager:void 0});function m(r,e,...t){if(Ct()&&e===void 0)throw new Error("invariant requires an error message argument");if(!r){let i;if(e===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let n=0;i=new Error(e.replace(/%s/g,function(){return t[n++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}function Ct(){return typeof process<"u"&&process.env.NODE_ENV==="production"}function It(r,e,t){return e.split(".").reduce((i,n)=>i&&i[n]?i[n]:t||null,r)}function Et(r,e){return r.filter(t=>t!==e)}function Ye(r){return typeof r=="object"}function xt(r,e){const t=new Map,i=s=>{t.set(s,t.has(s)?t.get(s)+1:1)};r.forEach(i),e.forEach(i);const n=[];return t.forEach((s,a)=>{s===1&&n.push(a)}),n}function Nt(r,e){return r.filter(t=>e.indexOf(t)>-1)}const De="dnd-core/INIT_COORDS",Z="dnd-core/BEGIN_DRAG",ye="dnd-core/PUBLISH_DRAG_SOURCE",K="dnd-core/HOVER",ee="dnd-core/DROP",te="dnd-core/END_DRAG";function Me(r,e){return{type:De,payload:{sourceClientOffset:e||null,clientOffset:r||null}}}const Rt={type:De,payload:{clientOffset:null,sourceClientOffset:null}};function Pt(r){return function(t=[],i={publishSource:!0}){const{publishSource:n=!0,clientOffset:s,getSourceClientOffset:a}=i,c=r.getMonitor(),h=r.getRegistry();r.dispatch(Me(s)),Mt(t,c,h);const u=Lt(t,c);if(u==null){r.dispatch(Rt);return}let D=null;if(s){if(!a)throw new Error("getSourceClientOffset must be defined");_t(a),D=a(u)}r.dispatch(Me(s,D));const l=h.getSource(u).beginDrag(c,u);if(l==null)return;kt(l),h.pinSource(u);const g=h.getSourceType(u);return{type:Z,payload:{itemType:g,item:l,sourceId:u,clientOffset:s||null,sourceClientOffset:D||null,isSourcePublic:!!n}}}}function Mt(r,e,t){m(!e.isDragging(),"Cannot call beginDrag while dragging."),r.forEach(function(i){m(t.getSource(i),"Expected sourceIds to be registered.")})}function _t(r){m(typeof r=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function kt(r){m(Ye(r),"Item must be an object.")}function Lt(r,e){let t=null;for(let i=r.length-1;i>=0;i--)if(e.canDragSource(r[i])){t=r[i];break}return t}function At(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ht(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(n){At(r,n,t[n])})}return r}function Bt(r){return function(t={}){const i=r.getMonitor(),n=r.getRegistry();jt(i),$t(i).forEach((a,c)=>{const h=Ft(a,c,n,i),u={type:ee,payload:{dropResult:Ht({},t,h)}};r.dispatch(u)})}}function jt(r){m(r.isDragging(),"Cannot call drop while not dragging."),m(!r.didDrop(),"Cannot call drop twice during one drag operation.")}function Ft(r,e,t,i){const n=t.getTarget(r);let s=n?n.drop(i,r):void 0;return Qt(s),typeof s>"u"&&(s=e===0?{}:i.getDropResult()),s}function Qt(r){m(typeof r>"u"||Ye(r),"Drop result must either be an object or undefined.")}function $t(r){const e=r.getTargetIds().filter(r.canDropOnTarget,r);return e.reverse(),e}function Ut(r){return function(){const t=r.getMonitor(),i=r.getRegistry();zt(t);const n=t.getSourceId();return n!=null&&(i.getSource(n,!0).endDrag(t,n),i.unpinSource()),{type:te}}}function zt(r){m(r.isDragging(),"Cannot call endDrag while not dragging.")}function de(r,e){return e===null?r===null:Array.isArray(r)?r.some(t=>t===e):r===e}function Wt(r){return function(t,{clientOffset:i}={}){qt(t);const n=t.slice(0),s=r.getMonitor(),a=r.getRegistry(),c=s.getItemType();return Gt(n,a,c),Vt(n,s,a),Xt(n,s,a),{type:K,payload:{targetIds:n,clientOffset:i||null}}}}function qt(r){m(Array.isArray(r),"Expected targetIds to be an array.")}function Vt(r,e,t){m(e.isDragging(),"Cannot call hover while not dragging."),m(!e.didDrop(),"Cannot call hover after drop.");for(let i=0;i<r.length;i++){const n=r[i];m(r.lastIndexOf(n)===i,"Expected targetIds to be unique in the passed array.");const s=t.getTarget(n);m(s,"Expected targetIds to be registered.")}}function Gt(r,e,t){for(let i=r.length-1;i>=0;i--){const n=r[i],s=e.getTargetType(n);de(s,t)||r.splice(i,1)}}function Xt(r,e,t){r.forEach(function(i){t.getTarget(i).hover(e,i)})}function Yt(r){return function(){if(r.getMonitor().isDragging())return{type:ye}}}function Jt(r){return{beginDrag:Pt(r),publishDragSource:Yt(r),hover:Wt(r),drop:Bt(r),endDrag:Ut(r)}}class Zt{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;function i(s){return(...a)=>{const c=s.apply(e,a);typeof c<"u"&&t(c)}}const n=Jt(this);return Object.keys(n).reduce((s,a)=>{const c=n[a];return s[a]=i(c),s},{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const i=this.store.getState().refCount>0;this.backend&&(i&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!i&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function Kt(r,e){return{x:r.x+e.x,y:r.y+e.y}}function Je(r,e){return{x:r.x-e.x,y:r.y-e.y}}function er(r){const{clientOffset:e,initialClientOffset:t,initialSourceClientOffset:i}=r;return!e||!t||!i?null:Je(Kt(e,i),t)}function tr(r){const{clientOffset:e,initialClientOffset:t}=r;return!e||!t?null:Je(e,t)}const q=[],Oe=[];q.__IS_NONE__=!0;Oe.__IS_ALL__=!0;function rr(r,e){return r===q?!1:r===Oe||typeof e>"u"?!0:Nt(e,r).length>0}class nr{subscribeToStateChange(e,t={}){const{handlerIds:i}=t;m(typeof e=="function","listener must be a function."),m(typeof i>"u"||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");let n=this.store.getState().stateId;const s=()=>{const a=this.store.getState(),c=a.stateId;try{c===n||c===n+1&&!rr(a.dirtyHandlerIds,i)||e()}finally{n=c}};return this.store.subscribe(s)}subscribeToOffsetChange(e){m(typeof e=="function","listener must be a function.");let t=this.store.getState().dragOffset;const i=()=>{const n=this.store.getState().dragOffset;n!==t&&(t=n,e())};return this.store.subscribe(i)}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return m(t,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(m(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const i=this.registry.getTargetType(e),n=this.getItemType();return de(i,n)&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(m(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const i=this.registry.getSourceType(e),n=this.getItemType();return i!==n?!1:t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;const{shallow:i}=t;if(!this.isDragging())return!1;const n=this.registry.getTargetType(e),s=this.getItemType();if(s&&!de(n,s))return!1;const a=this.getTargetIds();if(!a.length)return!1;const c=a.indexOf(e);return i?c===a.length-1:c>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return er(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return tr(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const _e=typeof global<"u"?global:self,Ze=_e.MutationObserver||_e.WebKitMutationObserver;function Ke(r){return function(){const t=setTimeout(n,0),i=setInterval(n,50);function n(){clearTimeout(t),clearInterval(i),r()}}}function ir(r){let e=1;const t=new Ze(r),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){e=-e,i.data=e}}const sr=typeof Ze=="function"?ir:Ke;class or{enqueueTask(e){const{queue:t,requestFlush:i}=this;t.length||(i(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let i=0,n=e.length-this.index;i<n;i++)e[i]=e[i+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=sr(this.flush),this.requestErrorThrow=Ke(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class ar{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}class cr{create(e){const t=this.freeTasks,i=t.length?t.pop():new ar(this.onError,n=>t[t.length]=n);return i.task=e,i}constructor(e){this.onError=e,this.freeTasks=[]}}const et=new or,lr=new cr(et.registerPendingError);function ur(r){et.enqueueTask(lr.create(r))}const Se="dnd-core/ADD_SOURCE",be="dnd-core/ADD_TARGET",Te="dnd-core/REMOVE_SOURCE",re="dnd-core/REMOVE_TARGET";function dr(r){return{type:Se,payload:{sourceId:r}}}function gr(r){return{type:be,payload:{targetId:r}}}function hr(r){return{type:Te,payload:{sourceId:r}}}function fr(r){return{type:re,payload:{targetId:r}}}function pr(r){m(typeof r.canDrag=="function","Expected canDrag to be a function."),m(typeof r.beginDrag=="function","Expected beginDrag to be a function."),m(typeof r.endDrag=="function","Expected endDrag to be a function.")}function mr(r){m(typeof r.canDrop=="function","Expected canDrop to be a function."),m(typeof r.hover=="function","Expected hover to be a function."),m(typeof r.drop=="function","Expected beginDrag to be a function.")}function ge(r,e){if(e&&Array.isArray(r)){r.forEach(t=>ge(t,!1));return}m(typeof r=="string"||typeof r=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var R;(function(r){r.SOURCE="SOURCE",r.TARGET="TARGET"})(R||(R={}));let vr=0;function Dr(){return vr++}function yr(r){const e=Dr().toString();switch(r){case R.SOURCE:return`S${e}`;case R.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${r}`)}}function ke(r){switch(r[0]){case"S":return R.SOURCE;case"T":return R.TARGET;default:throw new Error(`Cannot parse handler ID: ${r}`)}}function Le(r,e){const t=r.entries();let i=!1;do{const{done:n,value:[,s]}=t.next();if(s===e)return!0;i=!!n}while(!i);return!1}class Or{addSource(e,t){ge(e),pr(t);const i=this.addHandler(R.SOURCE,e,t);return this.store.dispatch(dr(i)),i}addTarget(e,t){ge(e,!0),mr(t);const i=this.addHandler(R.TARGET,e,t);return this.store.dispatch(gr(i)),i}containsHandler(e){return Le(this.dragSources,e)||Le(this.dropTargets,e)}getSource(e,t=!1){return m(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return m(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return m(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return m(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return ke(e)===R.SOURCE}isTargetId(e){return ke(e)===R.TARGET}removeSource(e){m(this.getSource(e),"Expected an existing source."),this.store.dispatch(hr(e)),ur(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){m(this.getTarget(e),"Expected an existing target."),this.store.dispatch(fr(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);m(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){m(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,i){const n=yr(e);return this.types.set(n,t),e===R.SOURCE?this.dragSources.set(n,i):e===R.TARGET&&this.dropTargets.set(n,i),n}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const Sr=(r,e)=>r===e;function br(r,e){return!r&&!e?!0:!r||!e?!1:r.x===e.x&&r.y===e.y}function Tr(r,e,t=Sr){if(r.length!==e.length)return!1;for(let i=0;i<r.length;++i)if(!t(r[i],e[i]))return!1;return!0}function wr(r=q,e){switch(e.type){case K:break;case Se:case be:case re:case Te:return q;case Z:case ye:case te:case ee:default:return Oe}const{targetIds:t=[],prevTargetIds:i=[]}=e.payload,n=xt(t,i);if(!(n.length>0||!Tr(t,i)))return q;const a=i[i.length-1],c=t[t.length-1];return a!==c&&(a&&n.push(a),c&&n.push(c)),n}function Cr(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Ir(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(n){Cr(r,n,t[n])})}return r}const Ae={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function Er(r=Ae,e){const{payload:t}=e;switch(e.type){case De:case Z:return{initialSourceClientOffset:t.sourceClientOffset,initialClientOffset:t.clientOffset,clientOffset:t.clientOffset};case K:return br(r.clientOffset,t.clientOffset)?r:Ir({},r,{clientOffset:t.clientOffset});case te:case ee:return Ae;default:return r}}function xr(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function U(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(n){xr(r,n,t[n])})}return r}const Nr={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Rr(r=Nr,e){const{payload:t}=e;switch(e.type){case Z:return U({},r,{itemType:t.itemType,item:t.item,sourceId:t.sourceId,isSourcePublic:t.isSourcePublic,dropResult:null,didDrop:!1});case ye:return U({},r,{isSourcePublic:!0});case K:return U({},r,{targetIds:t.targetIds});case re:return r.targetIds.indexOf(t.targetId)===-1?r:U({},r,{targetIds:Et(r.targetIds,t.targetId)});case ee:return U({},r,{dropResult:t.dropResult,didDrop:!0,targetIds:[]});case te:return U({},r,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return r}}function Pr(r=0,e){switch(e.type){case Se:case be:return r+1;case Te:case re:return r-1;default:return r}}function Mr(r=0){return r+1}function _r(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(n){_r(r,n,t[n])})}return r}function Lr(r={},e){return{dirtyHandlerIds:wr(r.dirtyHandlerIds,{type:e.type,payload:kr({},e.payload,{prevTargetIds:It(r,"dragOperation.targetIds",[])})}),dragOffset:Er(r.dragOffset,e),refCount:Pr(r.refCount,e),dragOperation:Rr(r.dragOperation,e),stateId:Mr(r.stateId)}}function Ar(r,e=void 0,t={},i=!1){const n=Hr(i),s=new nr(n,new Or(n)),a=new Zt(n,s),c=r(a,e,t);return a.receiveBackend(c),a}function Hr(r){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return mt(Lr,r&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function Br(r,e){if(r==null)return{};var t=jr(r,e),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)i=s[n],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(r,i)||(t[i]=r[i]))}return t}function jr(r,e){if(r==null)return{};var t={},i=Object.keys(r),n,s;for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&(t[n]=r[n]);return t}let He=0;const Y=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Fr=S.exports.memo(function(e){var{children:t}=e,i=Br(e,["children"]);const[n,s]=Qr(i);return S.exports.useEffect(()=>{if(s){const a=tt();return++He,()=>{--He===0&&(a[Y]=null)}}},[]),o(Xe.Provider,{value:n,children:t})});function Qr(r){if("manager"in r)return[{dragDropManager:r.manager},!1];const e=$r(r.backend,r.context,r.options,r.debugMode),t=!r.context;return[e,t]}function $r(r,e=tt(),t,i){const n=e;return n[Y]||(n[Y]={dragDropManager:Ar(r,e,t,i)}),n[Y]}function tt(){return typeof global<"u"?global:window}var Ur=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var i,n,s;if(Array.isArray(e)){if(i=e.length,i!=t.length)return!1;for(n=i;n--!==0;)if(!r(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(t).length)return!1;for(n=i;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;for(n=i;n--!==0;){var a=s[n];if(!r(e[a],t[a]))return!1}return!0}return e!==e&&t!==t};const B=typeof window<"u"?S.exports.useLayoutEffect:S.exports.useEffect;function zr(r,e,t){const[i,n]=S.exports.useState(()=>e(r)),s=S.exports.useCallback(()=>{const a=e(r);Ur(i,a)||(n(a),t&&t())},[i,r,t]);return B(s),[i,s]}function Wr(r,e,t){const[i,n]=zr(r,e,t);return B(function(){const a=r.getHandlerId();if(a!=null)return r.subscribeToStateChange(n,{handlerIds:[a]})},[r,n]),i}function rt(r,e,t){return Wr(e,r||(()=>({})),()=>t.reconnect())}function nt(r,e){const t=[...e||[]];return e==null&&typeof r!="function"&&t.push(r),S.exports.useMemo(()=>typeof r=="function"?r():r,t)}function qr(r){return S.exports.useMemo(()=>r.hooks.dragSource(),[r])}function Vr(r){return S.exports.useMemo(()=>r.hooks.dragPreview(),[r])}let ie=!1,se=!1;class Gr{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){m(!ie,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return ie=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{ie=!1}}isDragging(){if(!this.sourceId)return!1;m(!se,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return se=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{se=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let oe=!1;class Xr{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;m(!oe,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return oe=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{oe=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function Yr(r,e,t){const i=t.getRegistry(),n=i.addTarget(r,e);return[n,()=>i.removeTarget(n)]}function Jr(r,e,t){const i=t.getRegistry(),n=i.addSource(r,e);return[n,()=>i.removeSource(n)]}function he(r,e,t,i){let n=t?t.call(i,r,e):void 0;if(n!==void 0)return!!n;if(r===e)return!0;if(typeof r!="object"||!r||typeof e!="object"||!e)return!1;const s=Object.keys(r),a=Object.keys(e);if(s.length!==a.length)return!1;const c=Object.prototype.hasOwnProperty.bind(e);for(let h=0;h<s.length;h++){const u=s[h];if(!c(u))return!1;const D=r[u],v=e[u];if(n=t?t.call(i,D,v,u):void 0,n===!1||n===void 0&&D!==v)return!1}return!0}function fe(r){return r!==null&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function Zr(r){if(typeof r.type=="string")return;const e=r.type.displayName||r.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function Kr(r){return(e=null,t=null)=>{if(!S.exports.isValidElement(e)){const s=e;return r(s,t),s}const i=e;return Zr(i),en(i,t?s=>r(s,t):r)}}function it(r){const e={};return Object.keys(r).forEach(t=>{const i=r[t];if(t.endsWith("Ref"))e[t]=r[t];else{const n=Kr(i);e[t]=()=>n}}),e}function Be(r,e){typeof r=="function"?r(e):r.current=e}function en(r,e){const t=r.ref;return m(typeof t!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),t?S.exports.cloneElement(r,{ref:i=>{Be(t,i),Be(e,i)}}):S.exports.cloneElement(r,{ref:e})}class tn{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){const t=this.dragPreview,i=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(i&&this.disconnectDragPreview(),!!this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}i&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!he(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!he(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=it({dragSource:(t,i)=>{this.clearDragSource(),this.dragSourceOptions=i||null,fe(t)?this.dragSourceRef=t:this.dragSourceNode=t,this.reconnectDragSource()},dragPreview:(t,i)=>{this.clearDragPreview(),this.dragPreviewOptions=i||null,fe(t)?this.dragPreviewRef=t:this.dragPreviewNode=t,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class rn{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;if(!!this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!he(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=it({dropTarget:(t,i)=>{this.clearDropTarget(),this.dropTargetOptions=i,fe(t)?this.dropTargetRef=t:this.dropTargetNode=t,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function z(){const{dragDropManager:r}=S.exports.useContext(Xe);return m(r!=null,"Expected drag drop context"),r}function nn(r,e){const t=z(),i=S.exports.useMemo(()=>new tn(t.getBackend()),[t]);return B(()=>(i.dragSourceOptions=r||null,i.reconnect(),()=>i.disconnectDragSource()),[i,r]),B(()=>(i.dragPreviewOptions=e||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,e]),i}function sn(){const r=z();return S.exports.useMemo(()=>new Gr(r),[r])}class on{beginDrag(){const e=this.spec,t=this.monitor;let i=null;return typeof e.item=="object"?i=e.item:typeof e.item=="function"?i=e.item(t):i={},i!=null?i:null}canDrag(){const e=this.spec,t=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(t):!0}isDragging(e,t){const i=this.spec,n=this.monitor,{isDragging:s}=i;return s?s(n):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,i=this.connector,{end:n}=e;n&&n(t.getItem(),t),i.reconnect()}constructor(e,t,i){this.spec=e,this.monitor=t,this.connector=i}}function an(r,e,t){const i=S.exports.useMemo(()=>new on(r,e,t),[e,t]);return S.exports.useEffect(()=>{i.spec=r},[r]),i}function cn(r){return S.exports.useMemo(()=>{const e=r.type;return m(e!=null,"spec.type must be defined"),e},[r])}function ln(r,e,t){const i=z(),n=an(r,e,t),s=cn(r);B(function(){if(s!=null){const[c,h]=Jr(s,n,i);return e.receiveHandlerId(c),t.receiveHandlerId(c),h}},[i,e,t,n,s])}function un(r,e){const t=nt(r,e);m(!t.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=sn(),n=nn(t.options,t.previewOptions);return ln(t,i,n),[rt(t.collect,i,n),qr(n),Vr(n)]}function dn(r){return S.exports.useMemo(()=>r.hooks.dropTarget(),[r])}function gn(r){const e=z(),t=S.exports.useMemo(()=>new rn(e.getBackend()),[e]);return B(()=>(t.dropTargetOptions=r||null,t.reconnect(),()=>t.disconnectDropTarget()),[r]),t}function hn(){const r=z();return S.exports.useMemo(()=>new Xr(r),[r])}function fn(r){const{accept:e}=r;return S.exports.useMemo(()=>(m(r.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class pn{canDrop(){const e=this.spec,t=this.monitor;return e.canDrop?e.canDrop(t.getItem(),t):!0}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function mn(r,e){const t=S.exports.useMemo(()=>new pn(r,e),[e]);return S.exports.useEffect(()=>{t.spec=r},[r]),t}function vn(r,e,t){const i=z(),n=mn(r,e),s=fn(r);B(function(){const[c,h]=Yr(s,n,i);return e.receiveHandlerId(c),t.receiveHandlerId(c),h},[i,e,n,t,s.map(a=>a.toString()).join("|")])}function st(r,e){const t=nt(r,e),i=hn(),n=gn(t.options);return vn(t,i,n),[rt(t.collect,i,n),dn(n)]}function ot(r){let e=null;return()=>(e==null&&(e=r()),e)}function Dn(r,e){return r.filter(t=>t!==e)}function yn(r,e){const t=new Set,i=s=>t.add(s);r.forEach(i),e.forEach(i);const n=[];return t.forEach(s=>n.push(s)),n}class On{enter(e){const t=this.entered.length,i=n=>this.isNodeInDocument(n)&&(!n.contains||n.contains(e));return this.entered=yn(this.entered.filter(i),[e]),t===0&&this.entered.length>0}leave(e){const t=this.entered.length;return this.entered=Dn(this.entered.filter(this.isNodeInDocument),e),t>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class Sn{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach(i=>{const n=this.config.exposeProperties[i];n!=null&&(t[i]={value:n(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const at="__NATIVE_FILE__",ct="__NATIVE_URL__",lt="__NATIVE_TEXT__",ut="__NATIVE_HTML__",je=Object.freeze(Object.defineProperty({__proto__:null,FILE:at,URL:ct,TEXT:lt,HTML:ut},Symbol.toStringTag,{value:"Module"}));function ae(r,e,t){const i=e.reduce((n,s)=>n||r.getData(s),"");return i!=null?i:t}const pe={[at]:{exposeProperties:{files:r=>Array.prototype.slice.call(r.files),items:r=>r.items,dataTransfer:r=>r},matchesTypes:["Files"]},[ut]:{exposeProperties:{html:(r,e)=>ae(r,e,""),dataTransfer:r=>r},matchesTypes:["Html","text/html"]},[ct]:{exposeProperties:{urls:(r,e)=>ae(r,e,"").split(`
`),dataTransfer:r=>r},matchesTypes:["Url","text/uri-list"]},[lt]:{exposeProperties:{text:(r,e)=>ae(r,e,""),dataTransfer:r=>r},matchesTypes:["Text","text/plain"]}};function bn(r,e){const t=pe[r];if(!t)throw new Error(`native type ${r} has no configuration`);const i=new Sn(t);return i.loadDataTransfer(e),i}function ce(r){if(!r)return null;const e=Array.prototype.slice.call(r.types||[]);return Object.keys(pe).filter(t=>{const i=pe[t];return i!=null&&i.matchesTypes?i.matchesTypes.some(n=>e.indexOf(n)>-1):!1})[0]||null}const Tn=ot(()=>/firefox/i.test(navigator.userAgent)),dt=ot(()=>Boolean(window.safari));class Fe{interpolate(e){const{xs:t,ys:i,c1s:n,c2s:s,c3s:a}=this;let c=t.length-1;if(e===t[c])return i[c];let h=0,u=a.length-1,D;for(;h<=u;){D=Math.floor(.5*(h+u));const g=t[D];if(g<e)h=D+1;else if(g>e)u=D-1;else return i[D]}c=Math.max(0,u);const v=e-t[c],l=v*v;return i[c]+n[c]*v+s[c]*l+a[c]*v*l}constructor(e,t){const{length:i}=e,n=[];for(let g=0;g<i;g++)n.push(g);n.sort((g,d)=>e[g]<e[d]?-1:1);const s=[],a=[];let c,h;for(let g=0;g<i-1;g++)c=e[g+1]-e[g],h=t[g+1]-t[g],s.push(c),a.push(h/c);const u=[a[0]];for(let g=0;g<s.length-1;g++){const d=a[g],T=a[g+1];if(d*T<=0)u.push(0);else{c=s[g];const f=s[g+1],p=c+f;u.push(3*p/((p+f)/d+(p+c)/T))}}u.push(a[a.length-1]);const D=[],v=[];let l;for(let g=0;g<u.length-1;g++){l=a[g];const d=u[g],T=1/s[g],f=d+u[g+1]-l-l;D.push((l-d-f)*T),v.push(f*T*T)}this.xs=e,this.ys=t,this.c1s=u,this.c2s=D,this.c3s=v}}const wn=1;function gt(r){const e=r.nodeType===wn?r:r.parentElement;if(!e)return null;const{top:t,left:i}=e.getBoundingClientRect();return{x:i,y:t}}function X(r){return{x:r.clientX,y:r.clientY}}function Cn(r){var e;return r.nodeName==="IMG"&&(Tn()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(r)))}function In(r,e,t,i){let n=r?e.width:t,s=r?e.height:i;return dt()&&r&&(s/=window.devicePixelRatio,n/=window.devicePixelRatio),{dragPreviewWidth:n,dragPreviewHeight:s}}function En(r,e,t,i,n){const s=Cn(e),c=gt(s?r:e),h={x:t.x-c.x,y:t.y-c.y},{offsetWidth:u,offsetHeight:D}=r,{anchorX:v,anchorY:l}=i,{dragPreviewWidth:g,dragPreviewHeight:d}=In(s,e,u,D),T=()=>{let L=new Fe([0,.5,1],[h.y,h.y/D*d,h.y+d-D]).interpolate(l);return dt()&&s&&(L+=(window.devicePixelRatio-1)*d),L},f=()=>new Fe([0,.5,1],[h.x,h.x/u*g,h.x+g-u]).interpolate(v),{offsetX:p,offsetY:b}=n,w=p===0||p,Q=b===0||b;return{x:w?p:f(),y:Q?b:T()}}class xn{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}}function Nn(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Qe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(n){Nn(r,n,t[n])})}return r}class Rn{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((t=this.dragOverTargetIds)===null||t===void 0?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var t;(t=this.window)===null||t===void 0||t.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,t,i){return this.sourcePreviewNodeOptions.set(e,i),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,i){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,i);const n=a=>this.handleDragStart(a,e),s=a=>this.handleSelectStart(a);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",n),t.addEventListener("selectstart",s),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",n),t.removeEventListener("selectstart",s),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const i=a=>this.handleDragEnter(a,e),n=a=>this.handleDragOver(a,e),s=a=>this.handleDrop(a,e);return t.addEventListener("dragenter",i),t.addEventListener("dragover",n),t.addEventListener("drop",s),()=>{t.removeEventListener("dragenter",i),t.removeEventListener("dragover",n),t.removeEventListener("drop",s)}}addEventListeners(e){!e.addEventListener||(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){!e.removeEventListener||(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return Qe({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions.get(e);return Qe({anchorX:.5,anchorY:.5,captureDraggingState:!1},t||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(je).some(t=>je[t]===e)}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=bn(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const t=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var i;return(i=this.rootElement)===null||i===void 0?void 0:i.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},t)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,i){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=n=>{const s=this.sourceNodes.get(n);return s&&gt(s)||null},this.endDragNativeItem=()=>{!this.isDraggingNativeItem()||(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=n=>Boolean(n&&this.document&&this.document.body&&this.document.body.contains(n)),this.endDragIfSourceWasRemovedFromDOM=()=>{const n=this.currentDragSourceNode;n==null||this.isNodeInDocument(n)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=n=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(n||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=n=>{if(n.defaultPrevented)return;const{dragStartSourceIds:s}=this;this.dragStartSourceIds=null;const a=X(n);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(s||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:a});const{dataTransfer:c}=n,h=ce(c);if(this.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){const D=this.monitor.getSourceId(),v=this.sourceNodes.get(D),l=this.sourcePreviewNodes.get(D)||v;if(l){const{anchorX:g,anchorY:d,offsetX:T,offsetY:f}=this.getCurrentSourcePreviewNodeOptions(),w=En(v,l,a,{anchorX:g,anchorY:d},{offsetX:T,offsetY:f});c.setDragImage(l,w.x,w.y)}}try{c==null||c.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(n.target);const{captureDraggingState:u}=this.getCurrentSourcePreviewNodeOptions();u?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(h)this.beginDragNativeItem(h);else{if(c&&!c.types&&(n.target&&!n.target.hasAttribute||!n.target.hasAttribute("draggable")))return;n.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=n=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(n.dataTransfer)}if(!this.enterLeaveCounter.enter(n.target)||this.monitor.isDragging())return;const{dataTransfer:c}=n,h=ce(c);h&&this.beginDragNativeItem(h,c)},this.handleTopDragEnter=n=>{const{dragEnterTargetIds:s}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=n.altKey,s.length>0&&this.actions.hover(s,{clientOffset:X(n)}),s.some(c=>this.monitor.canDropOnTarget(c))&&(n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=n=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var s;(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(n.dataTransfer)}},this.handleTopDragOver=n=>{const{dragOverTargetIds:s}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="none");return}this.altKeyPressed=n.altKey,this.lastClientOffset=X(n),this.scheduleHover(s),(s||[]).some(c=>this.monitor.canDropOnTarget(c))?(n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?n.preventDefault():(n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=n=>{this.isDraggingNativeItem()&&n.preventDefault(),this.enterLeaveCounter.leave(n.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=n=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var s;n.preventDefault(),(s=this.currentNativeSource)===null||s===void 0||s.loadDataTransfer(n.dataTransfer)}else ce(n.dataTransfer)&&n.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=n=>{const{dropTargetIds:s}=this;this.dropTargetIds=[],this.actions.hover(s,{clientOffset:X(n)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=n=>{const s=n.target;typeof s.dragDrop=="function"&&(s.tagName==="INPUT"||s.tagName==="SELECT"||s.tagName==="TEXTAREA"||s.isContentEditable||(n.preventDefault(),s.dragDrop()))},this.options=new xn(t,i),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new On(this.isNodeInDocument)}}const Pn=function(e,t,i){return new Rn(e,t,i)};class Mn{constructor(){ne(this,"MIN_CHAR",this.byte("0"));ne(this,"MAX_CHAR",this.byte("z"))}insert(e,t){e==""&&(e=this.string(this.MIN_CHAR)),t==""&&(t=this.string(this.MAX_CHAR));let i="",n=0;for(;;){let s=this.getChar(e,n,this.MIN_CHAR),a=this.getChar(t,n,this.MAX_CHAR);if(s==a){i+=this.string(s),n++;continue}let c=this.mid(s,a);if(c==s||c==a){i+=this.string(s),n++;continue}i+=this.string(c);break}return i>=t?[e,!1]:[i,!0]}string(e){return String.fromCharCode(e)}byte(e){return e.charCodeAt(0)}mid(e,t){return Math.floor((e+t)/2)}getChar(e,t,i){return console.log(e,t),t>=e.length?i:this.byte(e.charAt(t))}}const _n=({index:r,boardId:e,workspaceId:t,role:i,card:n,lists:s})=>{const a=j();ze();const c=S.exports.useCallback((d,T,f,p)=>{_.put(`/card/${d}/dnd`,{newPos:T,destListId:f,direction:p}).then(b=>{b.data.refetch&&a.invalidateQueries(["getBoardList",e])}).catch(b=>{if(b.response){const w=b.response,{message:Q}=w.data;switch(w.status){case 403:case 404:g(C({kind:I.ERROR,msg:Q})),a.invalidateQueries(["getWorkSpaces"]),a.invalidateQueries(["getFavorites"]),a.invalidateQueries(["getBoard",e]),a.invalidateQueries(["getBoardList",e]),a.invalidateQueries(["getWorkSpaceBoards",t]),a.invalidateQueries(["getWorkSpaceSettings",t]),a.invalidateQueries(["getWorkSpaceMembers",t]);break;case 400:case 500:g(C({kind:I.ERROR,msg:Q}));break;default:g(C({kind:I.ERROR,msg:"Oops, something went wrong"}));break}}else b.request?g(C({kind:I.ERROR,msg:"Oops, something went wrong"})):g(C({kind:I.ERROR,msg:`Error: ${b.message}`}))})},[e,t]),h=(d,T)=>{const{source:f,destination:p,draggableId:b,type:w}=d;if(console.log(d),!p||f.index===p.index&&f.droppableId.toString()===p.droppableId.toString())return;const Q=T.sort((L,W)=>L.pos<W.pos?-1:L.pos>W.pos?1:0),M=new Mn;if(w==="CARD"){const L=Q.map(O=>O.cards),W=Array.prototype.concat.apply([],L);let we=[];const V=W.filter(O=>O.listId.toString()===f.droppableId.toString()).sort((O,E)=>O.position<E.position?-1:O.position>E.position?1:0),k=W.filter(O=>O.listId.toString()===p.droppableId.toString()).sort((O,E)=>O.position<E.position?-1:E.position>E.position?1:0),G=k[p.index-1],ht=k[p.index+1];V[f.index];const N=k[p.index];if(console.log(k),f.droppableId.toString()===p.droppableId.toString()){let O,E;if(f.index>p.index)if(E=xe.UP,G){const[x]=M.insert(G.position,N.position);O=x}else{const[x]=M.insert("0",N.position);O=x}else if(E=xe.DOWN,ht){const[x]=M.insert(N.position,N.position);O=x}else{const[x]=M.insert(N.position,"");O=x}c(b,O,p.droppableId,E),we=[...V].map(x=>x._id.toString()===b.toString()?{...x,pos:O}:x).sort((x,$)=>x.position>$.position?1:x.position<$.position?-1:0),a.setQueryData(["getBoardList",e],x=>x.map($=>$._id.toString()==f.droppableId.toString()?{...$,cards:we}:$));return}let A;if(k.length===0)A="a";else if(k.length===1)if(N){console.log(N,N.position);const[O]=M.insert("0",N.position);A=O}else{const[O]=M.insert(N.position,"");A=O}else if(p.index===0){const[O]=M.insert("0",N.position);A=O}else if(p.index===k.length){const[O]=M.insert(G.position,"");A=O}else{const[O]=M.insert(G.position,N.position);A=O}c(b,A,p.droppableId);const Ce=[...V].filter(O=>O._id.toString()===b.toString()),Ie=[...V].filter(O=>O._id.toString()!==b.toString()),Ee=[...k,...Ce].sort((O,E)=>O.position>E.position?1:O.position<E.position?-1:0);console.log(Ee,Ce,Ie),a.setQueryData(["getBoardList",e],O=>O.map(E=>E._id.toString()===f.droppableId.toString()?{...E,cards:Ie}:E._id.toString()===p.droppableId.toString()?{...E,cards:Ee}:E)),console.log(T)}},u=S.exports.useRef(null),[,D]=st({accept:"Our first type",hover(d,T){if(!u.current)return;const f=d.index,p=r;f!==p&&console.log(d,p,f)}}),[{isDragging:v},l]=un(()=>({type:qe.CARD,item:{draggableId:n._id,index:r},end:(d,T)=>{const f=T.getDropResult(),p={source:{index:d.index,droppableId:n.listId},destination:{index:0,droppableId:f.destination.droppableId},draggableId:d.draggableId,type:"CARD"};h(p,s)},collect:d=>({isDragging:!!d.isDragging()})})),g=F();return l(D(u)),y("div",{ref:u,className:"cardWrapper cursor-pointer w-full px-1 py-1 shadow m-1 rounded flex flex-col",style:{maxWidth:"30vw",minWidth:"15vw",opacity:`${v?.4:1}`},onClick:()=>g(P({modalType:"CARD_DETAIL_MODAL",modalProps:{_id:n._id,boardId:e,workspaceId:t}})),children:[y("div",{className:"cardHeader w-full p-1 flex justify-between items-center",children:[o("h3",{className:"font-semibold",children:n.name}),o("button",{className:"cursor-pointer hover:opacity-70",onClick:()=>g(P({modalType:"CARD_DETAIL_MODAL",modalProps:{_id:n._id,boardId:e,workspaceId:t}})),children:y("span",{children:[o(We,{size:25})," "]})})]}),y("div",{className:"cardBody w-full flex flex-col justify-center",children:[(n.coverImage||n.color)&&o("div",{className:"mb-2 w-full rounded-t",children:n.coverImage?o("img",{src:n.coverImage,className:"w-full h-full rounded-t"}):o("div",{className:"w-full h-full rounded-t",style:{height:"100px",background:`${n.color}`}})}),n.labels&&n.labels.length>0&&o("div",{className:"flex items-center flex-wrap gap-2 px-2 my-2",children:n.labels.map(d=>o("div",{style:{background:d.color},className:"text-sm p-1 rounded font-semibold text-white",children:d.name&&d.name.length>25?d.name.slice(0,25)+"...":d.name},d._id))}),n.description&&o("div",{children:o("span",{className:"",children:n.description})}),n.expireDate&&y("div",{className:`flex items-center rounded text-sm ${n.isComplete?"bg-green text-white p-1":new Date(n.expireDate)<new Date(Date.now())?"bg-red text-white p-1":""}`,children:[o(vt,{size:20,className:"mr-2"}),o("span",{children:Dt(new Date(n.expireDate),"dd/MM/yyyy")})]}),n.comments?y("div",{className:"flex my-1 items-center ",children:[o(yt,{size:20,className:"mr-3"}),o("span",{children:n.comments.length})]}):o(H,{})]}),o("div",{className:"flex items-center",children:n.members&&(n.members.length>8?y(H,{children:[n.members.slice(0,8).map(d=>o(le,{src:d.avatar,size:30,classes:"w-7 h-7 cursor-default"},d._id)),y("span",{children:["+",n.members.slice(8).length]})]}):n.members.map(d=>o(le,{src:d.avatar,alt:d.username,size:30,classes:"w-7 h-7 cursor-default"},d._id)))})]})};function kn({list:r,cards:e,boardId:t,workspaceId:i,role:n,index:s,lists:a}){const c=F();j();const[{canDrop:h,isOver:u},D]=st({accept:qe.CARD,drop:()=>({destination:{index:s,droppableId:r._id}}),collect:v=>({isOver:v.isOver(),canDrop:v.canDrop()})});return y("div",{className:"list flex flex-col px-2 py-1 mx-3 my-2 bg-surface rounded shadow ",style:{minHeight:"20vh",minWidth:"25%"},children:[o("header",{className:"w-full flex justify-between items-center rounded shadow-xl",children:["ADMIN","NORMAL"].includes(n)?y(H,{children:[o("h2",{className:"font-semibold text-lg py-2",children:r.name}),o("button",{className:"mr-2 rounded p-2",onClick:()=>c(P({modalType:"CONFIRM_DELETE_LIST_MODAL",modalProps:{listId:r._id,boardId:t,worspaceId:i}})),children:o(Ve,{size:20})})]}):o("h2",{className:"font-semibold text-lg py-2",children:r.name})}),o("div",{className:`p-2 ${u?"bg-slate-200":""}`,ref:D,style:{minHeight:"100px"},children:e&&(e==null?void 0:e.length)>0&&e.map((v,l)=>o(_n,{card:v,boardId:t,workspaceId:i,role:n,index:l,lists:a},l))}),["ADMIN","NORMAL"].includes(n)&&y("div",{className:"rounded flex flex-col items-center py-2 justify-center w-full",children:[o("h1",{className:"font-semibold",children:"Create a new card."}),o("button",{className:"px-3 py-1 bg-secondary hover:bg-secondary_light text-white rounded",onClick:()=>c(P({modalType:"CREATE_CARD_MODAL",modalProps:{listId:r._id,boardId:t,cardLength:e==null?void 0:e.length}})),children:o(ue,{})})]})]})}function Ln({boardId:r,boardName:e,workspaceId:t,myRole:i}){const n=F(),s=j(),{show:a}=me(v=>v.sidebar),c=async({queryKey:v})=>{const g=(await _(`/${v[1]}/lists`)).data;return console.log(g.lists),g.lists},{isLoading:h,data:u,error:D}=J(["getBoardList",r],c);return S.exports.useCallback((v,l,g)=>{_.put(`/lists/${v}/dnd`,{newPosition:l,direction:g}).then(d=>{d.data,s.invalidateQueries(["getBoardList",r])}).catch(d=>{if(d.response){const T=d.response,{message:f}=T.data;switch(T.status){case 403:n(C({kind:I.ERROR,msg:f})),s.invalidateQueries(["getBoard",r]),s.invalidateQueries(["getBoardList",r]),s.invalidateQueries(["getWorkSpaces"]),s.invalidateQueries(["getFavorites"]);break;case 404:n(C({kind:I.ERROR,msg:f})),s.invalidateQueries(["getBoard",r]),s.invalidateQueries(["getBoardList",r]),s.invalidateQueries(["getWorkSpaces"]),s.invalidateQueries(["getFavorites"]),s.invalidateQueries(["getWorkSpaceBoards",t]),s.invalidateQueries(["getWorkSpaceSettings",t]),s.invalidateQueries(["getWorSpaceMembers",t]);break;case 400:case 500:n(C({kind:I.ERROR,msg:f}));break;default:n(C({kind:I.ERROR,msg:"Oops, something went wrong"}));break}}else d.request?n(C({kind:I.ERROR,msg:"Oops, something went wrong"})):n(C({kind:I.ERROR,msg:`Error: ${d.message}`}))})},[r,t]),h?o("div",{className:"w-full h-full flex items-center justify-center",children:o(Ge,{})}):D?y("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[o("h1",{children:"Oops! Something went wrong!"}),o("h2",{}),o("button",{children:"Retry"})]}):o("div",{className:"flex relative w-full h-full",children:u&&(u==null?void 0:u.length)>0?y("div",{className:"w-full h-full relative flex flex-col md:flex-row  items-start justify-start px-2 py-2  overflow-x-auto overflow-y-auto",style:{maxWidth:`${a?"75vw":"98vw"}`,maxHeight:"80vh"},children:[o(Fr,{backend:Pn,children:u==null?void 0:u.map((v,l)=>o(kn,{list:v,boardId:r,cards:v.cards,role:i,workspaceId:t,index:l,lists:u},l))}),y("div",{className:"bg-board mx-2 my-2 rounded flex flex-col items-center justify-center px-2 py-8",style:{minHeight:"60vh",minWidth:"17vw"},children:[o("h1",{className:"font-semibold text-lg mx-2 my-1 text-center",children:"Create a new List."}),y("button",{className:"px-4 py-1 mx-4 my-2 bg-secondary text-white flex rounded hover:opacity-50",onClick:()=>n(P({modalType:"CREATE_LIST_MODAL",modalProps:{boardName:e,listLength:u==null?void 0:u.length}})),children:[o("span",{className:"font-semibold",children:"Add"}),o("span",{className:"rounded-full p-1 bg-white text-black ml-1",children:o(Ne,{size:15})})]})]})]}):y("div",{className:"w-full h-full px-3 py-2 flex flex-col",children:[o("h1",{className:"font-semibold text-xl text-center h-20",children:"No Lists."}),y("div",{className:"bg-board mx-2 my-2 rounded flex flex-col items-center justify-center px-3 py-4",style:{minHeight:"40vh"},children:[o("h1",{className:"font-semibold text-lg mx-2 my-1 text-center",children:"Create a new List."}),y("button",{className:"px-4 py-1 mx-4 my-2 bg-secondary text-white flex rounded hover:opacity-50",onClick:()=>n(P({modalType:"CREATE_LIST_MODAL",modalProps:{boardName:e,listLength:u==null?void 0:u.length}})),children:[o("span",{className:"font-semibold",children:"Add"}),o("span",{className:"rounded-full p-1 bg-white text-black ml-1",children:o(Ne,{size:15})})]})]})]})})}function An({member:r,boardId:e,workspaceId:t,myRole:i,boardAdmins:n}){const s=F();me(v=>v.auth),S.exports.useState(null);const[a,c]=S.exports.useState(!1),u=!!(n!=null&&n.find(v=>v._id===(r==null?void 0:r._id)))&&(n==null?void 0:n.length)===1,D=()=>{};return o(H,{children:y("div",{className:"relative ",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[a&&["ADMIN"].includes(i)&&o("div",{className:"absolute top-0 right-0",children:o("button",{onClick:()=>D(),children:o(ve,{size:15,className:"font-semibold hover:opacity-60"})})}),o("button",{onClick:()=>s(P({modalType:"BOARD_MEMBER_UPDATE_MODAL",modalProps:{member:r,myRole:i,boardId:e,workspaceId:t,isOnlyAdmin:u}})),className:"hover:opacity-60 mt-2 mr-2",children:o(le,{src:r.avatar,size:30})})]})})}function Hn({boardId:r,workspaceId:e,role:t,members:i}){const n=i.filter(s=>s.role==="ADMIN");return o("div",{className:"bg-slate-200 py-1 rounded mt-2 px-1",children:i.length>0?o("div",{className:"flex gap-1 items-center",children:i.map(s=>o(An,{boardId:r,member:s,boardAdmins:n,myRole:t,workspaceId:e},s._id))}):o("div",{children:"No Members"})})}function Bn({name:r,color:e,boardId:t,labelId:i}){const n=j(),[s,a]=S.exports.useState(!1),c=h=>{_.delete(`/board/${t}/labels`,{data:{labelId:h}}).then(u=>{console.log(u.data.message),n.invalidateQueries(["getAllLables",t])}).catch(u=>{})};return y("div",{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),className:" flex flex-col px-3 py-2 relative rounded",style:{background:e},children:[s&&o("button",{className:"absolute top-0 right-0 hover:opacity-60 bg-slate-100 rounded-full",onClick:()=>c(i),children:o(ve,{size:15})}),o("span",{children:r})]})}const jn=({setShowMenu:r,boardId:e,workspaceId:t,myRole:i})=>{const[n,s]=S.exports.useState(null);j();const a=F(),c=async({queryKey:g})=>{const T=(await _.get(`/board/${g[1]}/labels`)).data.labels;return console.log(T),T},h=async({queryKey:g})=>(await _.get(`/board/${g[1]}/members`)).data.AllMembers,{isLoading:u,data:D,error:v}=J(["getAllBoardMembers",e],h),{data:l}=J(["getAllLabels",e],c);return y("div",{className:"w-80 relative z-10 shadow-xl h-88 overflow-y-auto",children:[o("button",{className:"absolute top-0 left-0 cursor-pointer p-2 hover:opacity-50",onClick:()=>r(!1),children:o(ve,{size:30})}),y("div",{className:"mt-16 px-2",children:[y("div",{className:"members mb-4",children:[y("div",{className:"flex w-full items-center justify-between",children:[y("button",{className:"labelsHeader w-full flex items-center cursor-pointer hover:opacity-50",onClick:()=>{s(g=>g===0?null:0)},children:[n===0?o(Re,{size:20}):o(Pe,{size:20}),o("h3",{className:"font-semibold ml-2 text-lg",children:"Board Members"})]}),o("button",{className:"hover:opacity-60",onClick:()=>a(P({modalType:"INVITE_BOARD_MEMBER_MODAL",modalProps:{boardId:e}})),children:o(ue,{size:20})})]}),n===0&&o(H,{children:D&&D.length>0?o(Hn,{boardId:e,workspaceId:t,members:D,role:i}):o("div",{className:"p-2 bg-slate-200 rounded mt-2",children:o("h2",{className:"font-semibold text-center text-primary ",children:"No Members"})})})]}),y("div",{className:"labels mt-2 mb-2",children:[y("div",{className:"flex w-full items-center justify-between",children:[y("button",{className:"labelsHeader w-full flex items-center cursor-pointer hover:opacity-50",onClick:()=>{s(g=>g===1?null:1)},children:[n===1?o(Re,{size:20}):o(Pe,{size:20}),o("h3",{className:"font-semibold ml-2 text-lg",children:"Labels"})]}),o("button",{className:"hover:opacity-60",onClick:()=>a(P({modalType:"BOARD_LABEL_MODAL",modalProps:{boardId:e}})),children:o(ue,{size:20})})]}),n===1&&o(H,{children:l&&l.length>0?o("div",{className:"labelsBody w-full flex gap-2",children:l==null?void 0:l.map(g=>o(Bn,{name:g.name,color:g.color,boardId:e,labelId:g._id},g.name))}):o("div",{className:"bg-slate-200 my-2 text-center",children:o("span",{className:"w-full font-semibold  p-2",children:"No Labels"})})})]})]})]})};function Fn({options:r=[],value:e,workspaceId:t,boardId:i}){F();const n=j(),[s,a]=S.exports.useState("");S.exports.useEffect(()=>{if(r&&r.length>0){const h=r.find(u=>u.value===e);a(h?h.value:r[0].value)}},[r]);const c=h=>{console.log(h.target.value),_.put(`/board/${i}/visibility`,{newVisibility:h.target.value}).then(u=>{console.log(u.data.message),n.invalidateQueries(["getRecentBoards"]),n.invalidateQueries(["getBoard",i]),n.invalidateQueries(["getWorkSpaces"]),n.invalidateQueries(["getFavorites"]),n.invalidateQueries(["getWorkSpaceBoards",t]),n.invalidateQueries(["getWorkSpaceSettings",t]),n.invalidateQueries(["getWorkSpaceMembers",t])}).catch(u=>{u.response&&u.response.data})};return o("div",{className:"flex mb-3 ",children:o("div",{className:"flex justify-center items-center",children:o("select",{name:"boardVisibility",id:"boardVisibility",value:s,onChange:h=>c(h),disabled:r.length===0,className:"px-2 py-1 border-2 border-black focus:boarder-2 focus:border-primary",children:r&&r.map(h=>o("option",{value:h.value,children:h.name},h.value))})})})}function $e(){return o("span",{className:"px-3 py-2 rounded bg-secondary text-white hover:bg-secondary_light ",children:"Invite"})}function Ue(){return o("button",{className:"px-3 py-2 bg-secondary text-white hover:bg-secondary_light",children:"Join"})}function Un(){const{boardId:r}=Ot(),e=F(),t=j(),i=ze(),{user:n}=me(d=>d.auth),[s,a]=S.exports.useState(!1);S.exports.useEffect(()=>{t.invalidateQueries(["getRecentBoards"])},[]);const c=(d,T)=>{_.post("/favorite/add",{resourceId:d,type:"BOARD"}).then(f=>{const p=f.data.favoriteResource;f.status===201&&(t.getQueryData(["getBoard",d])&&t.setQueryData(["getBoard",d],b=>({...b,isFavorite:!0,favoriteId:p._id})),t.getQueryData(["getWorkSpaceBoards",T])&&t.setQueryData(["getWorkSpaceBoards",T],b=>b.map(w=>w._id===d?{...w,isFavorite:!0,favoriteId:p._id}:w)),t.getQueryData(["getFavorites"])&&t.setQueryData(["getFavorites"],b=>[...b,p]))}).catch(f=>{if(f.response){const p=f.response,{message:b}=p.data;switch(p.status){case 404:e(C({kind:I.ERROR,msg:b})),t.invalidateQueries(["getWorkSpaces"]),t.invalidateQueries(["getFavorites"]),i("/home/page",{replace:!0});break;case 400:case 500:e(C({kind:I.ERROR,msg:b}));break;default:e(C({kind:I.ERROR,msg:"Oops, something went wrong"}))}}else f.request?e(C({kind:I.ERROR,msg:"Oops, something went wrong"})):e(C({kind:I.ERROR,msg:`Error: ${f.message}`}))})},h=(d,T,f)=>{_.delete(`/favorite/${d}`).then(p=>{t.getQueryData(["getBoard",T])&&t.setQueryData(["getBoard",T],b=>({...b,isFavorite:!1,favoriteId:null})),t.getQueryData(["getWorkSpaceBoards",f])&&t.setQueryData(["getWorkSpaceBoards",f],b=>b.map(w=>w._id===T?{...w,isFavorite:!1,favoriteId:null}:w)),t.getQueryData(["getFavorites"])&&t.setQueryData(["getFavorites"],b=>b.filter(w=>w._id.toString()!==d))}).catch(p=>{if(p.response){const b=p.response,{message:w}=b.data;switch(b.status){case 404:e(C({kind:I.ERROR,msg:w})),t.invalidateQueries(["getWorkSpaces"]),t.invalidateQueries(["getFavorites"]),i("/home/page",{replace:!0});break;case 400:case 500:e(C({kind:I.ERROR,msg:w}));break;default:e(C({kind:I.ERROR,msg:"Oops, something went wrong"}))}}else p.request?e(C({kind:I.ERROR,msg:"Oops, something went wrong"})):e(C({kind:I.ERROR,msg:`Error: ${p.message}`}))})},u=[{value:"PUBLIC",name:"PUBLIC"},{value:"PRIVATE",name:"PRIVATE"}],D=async({queryKey:d})=>{const f=(await _(`board/${d[1]}`)).data;return console.log(f.board),f.board},{isLoading:v,data:l,error:g}=J(["getBoard",r],D);return v?o("div",{className:"flex w-full justify-center items-center",children:o(Ge,{})}):g?y("div",{className:"flex w-full items-center justify-center",children:[o("h3",{children:"Oops! something went wrong"}),o("button",{children:"Retry"})]}):y("div",{className:"h-full relative flex overflow-hidden",children:[l&&y("div",{className:"flex-1",children:[o("div",{className:" fixed top-0 bottom-0 right-0 left-0",style:{backgroundImage:`url(${l.bgImage})`,backgroundColor:l.bgImage?"":l.color,zIndex:-1,backgroundPosition:"50%",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundBlendMode:"overlay",boxShadow:"0 0 0 2000px rgba(150, 150, 150, 0.3)"}}),o("div",{className:"flex flex-col relative z-10 bg-",children:y("div",{className:"header h-16 w-full px-4 py-2 flex items-center justify-between z-10 ",children:[y("div",{className:"flex items-center flex-1 gap-x-4",children:[y("div",{className:" bg-surface px-3 py-1 flex flex-col items-center justify-center  ",children:[y("div",{className:"  workspaceName-container w-full flex items-center shadow hover:shadow-none ",children:[o(St,{src:l.workspace.picture,alt:l.workspace.name,size:40,classes:"rounded-full"}),o("span",{className:"ml-3",children:l.workspace.name})]}),o("span",{className:" font-semibold text-xl w-full",children:l.name})]}),o("div",{className:"favourite p-2 cursor-pointer bg-[#ffffcf] shadow hover:shadow-none  hover:opacity-50",children:l.isFavorite?o("button",{onClick:()=>h(l.FavoriteId,l._id,l.workspace._id),children:o(bt,{color:"#ffd700",size:30})}):o("button",{onClick:()=>c(l._id,l.workspace._id),children:o(Tt,{color:"#ffd700",size:30})})}),o("div",{className:"boardVisibility  rounded font-semibold  shadow hover:shadow-none hover:opacity-50",children:l.role==="ADMIN"?o(Fn,{options:u,workspaceId:l.workspace._id,boardId:r,value:l.visibility}):o("div",{className:"px-4 py-2 bg-board",children:l.visibility})}),l.role==="ADMIN"&&y("div",{className:"flex ",children:[o("button",{onClick:()=>e(P({modalType:"INVITE_BOARD_MEMBER_MODAL",modalProps:{boardId:r}})),className:"mr-3",children:o($e,{})}),!l.members.find(d=>d._id===(n==null?void 0:n._id))&&o("button",{children:o(Ue,{})})]}),l.role==="NORMAL"&&o(H,{children:l.members.find(d=>d._id===(n==null?void 0:n._id))?o($e,{}):o(Ue,{})})]}),y("div",{className:"editWrapper flex items-center flex-1 justify-end mr-4",children:[l.role==="ADMIN"&&o("div",{className:"shadow px-2 py-1 bg-board hover:opacity-50 mr-3",children:o("button",{onClick:()=>e(P({modalType:"BOARD_DETAIL_MODAL",modalProps:{boardId:r,workspaceId:l.workspace._id}})),children:o(wt,{size:30})})}),l.role==="ADMIN"&&o("div",{className:"shadow mr-2 bg-board rounded px-2 py-1",children:o("button",{className:"w-full",onClick:()=>e(P({modalType:"CONFIRM_DELETE_BOARD_MODAL",modalProps:{boardId:r,workspaceId:l.workspace._id,myRole:l.role}})),children:o(Ve,{size:30})})}),!s&&o("div",{className:"shadow hover:shadow-none bg-board  px-2 py-2  hover:opacity-50",children:o("button",{onClick:()=>a(d=>!d),children:o(We,{})})})]})]})}),o("div",{className:" w-full h-full z-10",children:o(Ln,{boardId:r,boardName:l.name,workspaceId:l.workspace._id,myRole:l.role})})]}),s&&o(jn,{setShowMenu:a,boardId:r,workspaceId:l==null?void 0:l.workspace._id,myRole:l==null?void 0:l.role})]})}export{Un as default};
